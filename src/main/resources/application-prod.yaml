# ==============================================================================
# APPLICATION CONFIGURATION - SECURITY SPACEE
# Profile: PRODUCTION
# ==============================================================================
# This file uses environment variables for all sensitive configuration.
# Activate with: --spring.profiles.active=prod
# ==============================================================================

spring:
  # ===========================================================================
  # DATABASE CONFIGURATION (PostgreSQL - Production)
  # ===========================================================================
  datasource:
    url: jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    hikari:
      maximum-pool-size: ${DB_POOL_SIZE}
      minimum-idle: ${DB_POOL_MIN_IDLE}

  # ===========================================================================
  # REDIS CACHE (Production)
  # ===========================================================================
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${REDIS_PASSWORD}

  # ===========================================================================
  # EMAIL (Production SMTP)
  # ===========================================================================
  mail:
    host: ${MAIL_HOST}
    port: ${MAIL_PORT}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true

# =============================================================================
# SERVER CONFIGURATION - Production
# =============================================================================
server:
  port: ${SERVER_PORT}

# =============================================================================
# ACTUATOR - Production (Disable non-critical health checks)
# =============================================================================
management:
  health:
    mail:
      enabled: false

# =============================================================================
# APPLICATION CUSTOM PROPERTIES - Production
# =============================================================================
application:
  # JWT Configuration (REQUIRED - Must be set via environment)
  jwt:
    secret: ${JWT_SECRET}
    issuer: ${JWT_ISSUER}
    audience: ${JWT_AUDIENCE}
    access-expiration: ${JWT_ACCESS_EXPIRATION}
    refresh-expiration: ${JWT_REFRESH_EXPIRATION}

  # Security - Production
  security:
    allowed-origins: ${ALLOWED_ORIGINS}
    max-login-attempts: ${MAX_LOGIN_ATTEMPTS}
    account-lock-duration: ${ACCOUNT_LOCK_DURATION}

  # Cache TTL
  cache:
    ttl:
      user-profile: ${CACHE_TTL_USER_PROFILE}
      user-roles: ${CACHE_TTL_USER_ROLES}
      permissions: ${CACHE_TTL_PERMISSIONS}
      jwt-blacklist: ${CACHE_TTL_JWT_BLACKLIST}

# =============================================================================
# SESSION CONFIGURATION (Production)
# =============================================================================
session:
  expiration: ${SESSION_EXPIRATION}
  concurrent:
    enabled: ${SESSION_CONCURRENT_ENABLED}
    default-max: ${SESSION_CONCURRENT_MAX}
    default-strategy: ${SESSION_CONCURRENT_STRATEGY}
    notify-new-device: ${SESSION_NOTIFY_NEW_DEVICE}
    geo-ip:
      enabled: ${SESSION_GEOIP_ENABLED}
      database-path: ${SESSION_GEOIP_DB_PATH}
    device-fingerprint:
      algorithm: SHA-256
  timeout:
    absolute: ${SESSION_TIMEOUT_ABSOLUTE}
    idle: ${SESSION_TIMEOUT_IDLE}
    sliding-expiration: ${SESSION_TIMEOUT_SLIDING}
    warning-threshold: ${SESSION_TIMEOUT_WARNING}
    cleanup:
      idle-check-interval: ${SESSION_CLEANUP_IDLE_INTERVAL}
      absolute-check-interval: ${SESSION_CLEANUP_ABSOLUTE_INTERVAL}
    activity-tracking:
      enabled: ${SESSION_ACTIVITY_TRACKING_ENABLED}
      async: ${SESSION_ACTIVITY_TRACKING_ASYNC}
      batch-updates: ${SESSION_ACTIVITY_TRACKING_BATCH}

# =============================================================================
# LOGGING - Production (Minimal, JSON format recommended)
# =============================================================================
logging:
  level:
    root: ${LOG_LEVEL_ROOT}
    "[com.spacecodee]": ${LOG_LEVEL_APP}
    "[org.springframework.web]": WARN
    "[org.springframework.security]": WARN
    "[org.hibernate.SQL]": ERROR
